Running containers in privileged mode deviates from the Defense in Depth
principle because it weakens the isolation of a pod from the rest of the
cluster.

Processes in privileged containers are essentially equivalent to root on the
host. If reliable security measures do not protect these processes, an attacker
who compromises a root process on a podâ€™s host can likely gain the ability to
move within the cluster. +
Depending on how resilient the cluster is, attackers can extend their attack to
the cluster by compromising the nodes from which the cluster launched the
process.

This situation should not occur unless the pod is 100% isolated and protected
from people who are not administrators of the Kubernetes cluster.

== Ask Yourself Whether


* This pod is accessible to people who are not administrators of the Kubernetes cluster.
* This pod is located on nodes that contain critical components of the cluster.

There is a risk if you answered yes to any of those questions.

== Recommended Secure Coding Practices

Disable privileged mode.

== Sensitive Code Example

----
apiVersion: v1
kind: Pod
metadata:
  name: example
spec:
  containers:
    - name: web
      image: nginx
      ports:
        - name: web
          containerPort: 80
          protocol: TCP
  securityContext:  
    privileged: true # Sensitive
----

== Compliant Solution

----
apiVersion: v1
kind: Pod
metadata:
  name: example
spec:
  containers:
    - name: web
      image: nginx
      ports:
        - name: web
          containerPort: 80
          protocol: TCP
  securityContext:  
    privileged: false
----

== See

* https://owasp.org/Top10/A01_2021-Broken_Access_Control/[OWASP Top 10 2021 Category A1] - Broken Access Control
* https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control[OWASP Top 10 2017 Category A5] - Broken Access Control
* https://cwe.mitre.org/data/definitions/284.html[MITRE, CWE-284] - Improper Access Control

ifdef::env-github,rspecator-view[]

'''
== Implementation Specification
(visible only on this page)

=== Message

Ensure that enabling privileged mode is safe here.

=== Highlighting

Highlight `privileged: true`.

endif::env-github,rspecator-view[]

Enabling public network access to Azure resources can affect the organisation's
ability to protect its data or internal operations from data theft or disruption.

Depending on which Azure resource is affected, different risks may exist.
In general, a data breach or general attack targeting the resource in question
can result in significant losses to the organisation.

== Ask Yourself Whether

* This Azure resource contains data that is important to the organisation's business or infrastructure.

There is a risk if you answered yes to this question.

== Recommended Secure Coding Practices

* Disable public network access to this Azure resource.

== Sensitive Code Example

For https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mysql_server[MySQL servers]:

----
resource "azurerm_mysql_server" "example" {
  name                          = "${var.prefix}-mysql"
  location                      = azurerm_resource_group.example.location
  resource_group_name           = azurerm_resource_group.example.name
  public_network_access_enabled = false # Compliant
}
----

== Compliant Solution

For https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mysql_server[MySQL servers]:

----
resource "azurerm_mysql_server" "example" {
  name                          = "${var.prefix}-mysql"
  location                      = azurerm_resource_group.example.location
  resource_group_name           = azurerm_resource_group.example.name
  public_network_access_enabled = true # Sensitive
}
----

== See

* https://owasp.org/Top10/A01_2021-Broken_Access_Control/[OWASP Top 10 2021 Category A1] - Boken Access Control
* https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control[OWASP Top 10 2017 Category A5] - Boken Access Control
* https://cwe.mitre.org/data/definitions/668.html[MITRE, CWE-668] - Exposure of Resource to Wrong Sphere

ifdef::env-github,rspecator-view[]

'''

== Implementation Specification
(visible only on this page)

=== Message

* Omitting {parameter} allows network access from the Internet. Make sure it is safe here.
* Make sure that enabling public network access is safe here.

=== Highlighting

* If {parameter} is missing, highlight the resource.
* If the assignment is non-compliant, highlight the entire assignment


endif::env-github,rspecator-view[]

